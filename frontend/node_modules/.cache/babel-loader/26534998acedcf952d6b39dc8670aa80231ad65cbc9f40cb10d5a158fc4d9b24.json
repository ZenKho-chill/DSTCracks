{"ast":null,"code":"'use strict';\n\nvar BN = require('bn.js');\nvar randomBytes = require('randombytes');\nvar Buffer = require('safe-buffer').Buffer;\nfunction getr(priv) {\n  var len = priv.modulus.byteLength();\n  var r;\n  do {\n    r = new BN(randomBytes(len));\n  } while (r.cmp(priv.modulus) >= 0 || !r.umod(priv.prime1) || !r.umod(priv.prime2));\n  return r;\n}\nfunction blind(priv) {\n  var r = getr(priv);\n  var blinder = r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed();\n  return {\n    blinder: blinder,\n    unblinder: r.invm(priv.modulus)\n  };\n}\nfunction crt(msg, priv) {\n  var blinds = blind(priv);\n  var len = priv.modulus.byteLength();\n  var blinded = new BN(msg).mul(blinds.blinder).umod(priv.modulus);\n  var c1 = blinded.toRed(BN.mont(priv.prime1));\n  var c2 = blinded.toRed(BN.mont(priv.prime2));\n  var qinv = priv.coefficient;\n  var p = priv.prime1;\n  var q = priv.prime2;\n  var m1 = c1.redPow(priv.exponent1).fromRed();\n  var m2 = c2.redPow(priv.exponent2).fromRed();\n  var h = m1.isub(m2).imul(qinv).umod(p).imul(q);\n  return m2.iadd(h).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer, 'be', len);\n}\ncrt.getr = getr;\nmodule.exports = crt;","map":{"version":3,"names":["BN","require","randomBytes","Buffer","getr","priv","len","modulus","byteLength","r","cmp","umod","prime1","prime2","blind","blinder","toRed","mont","redPow","publicExponent","fromRed","unblinder","invm","crt","msg","blinds","blinded","mul","c1","c2","qinv","coefficient","p","q","m1","exponent1","m2","exponent2","h","isub","imul","iadd","toArrayLike","module","exports"],"sources":["D:/dstcracks/DSTCracks/frontend/node_modules/browserify-rsa/index.js"],"sourcesContent":["'use strict';\r\n\r\nvar BN = require('bn.js');\r\nvar randomBytes = require('randombytes');\r\nvar Buffer = require('safe-buffer').Buffer;\r\n\r\nfunction getr(priv) {\r\n\tvar len = priv.modulus.byteLength();\r\n\tvar r;\r\n\tdo {\r\n\t\tr = new BN(randomBytes(len));\r\n\t} while (r.cmp(priv.modulus) >= 0 || !r.umod(priv.prime1) || !r.umod(priv.prime2));\r\n\treturn r;\r\n}\r\n\r\nfunction blind(priv) {\r\n\tvar r = getr(priv);\r\n\tvar blinder = r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed();\r\n\treturn { blinder: blinder, unblinder: r.invm(priv.modulus) };\r\n}\r\n\r\nfunction crt(msg, priv) {\r\n\tvar blinds = blind(priv);\r\n\tvar len = priv.modulus.byteLength();\r\n\tvar blinded = new BN(msg).mul(blinds.blinder).umod(priv.modulus);\r\n\tvar c1 = blinded.toRed(BN.mont(priv.prime1));\r\n\tvar c2 = blinded.toRed(BN.mont(priv.prime2));\r\n\tvar qinv = priv.coefficient;\r\n\tvar p = priv.prime1;\r\n\tvar q = priv.prime2;\r\n\tvar m1 = c1.redPow(priv.exponent1).fromRed();\r\n\tvar m2 = c2.redPow(priv.exponent2).fromRed();\r\n\tvar h = m1.isub(m2).imul(qinv).umod(p).imul(q);\r\n\treturn m2.iadd(h).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer, 'be', len);\r\n}\r\ncrt.getr = getr;\r\n\r\nmodule.exports = crt;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}